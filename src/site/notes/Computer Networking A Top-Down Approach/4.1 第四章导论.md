---
{"created":"2026-01-03T23:00","updated":"2026-01-04T08:18","dg-publish":true,"permalink":"/Computer Networking A Top-Down Approach/4.1 第四章导论/","dgPassFrontmatter":true,"noteIcon":""}
---

### 网络层服务
在发送主机和接受主机之间传送段(segment)
在发送端将段封装到IP数据报(IP Datagram)中，具体来说就是网络层会将TCP的segment作为数据payload部分，在前面再加上一个IP头部(IP header)，形成网络层的IP数据单元，叫IP Datagram，也叫packet(分组)
接收端会解封装将收到的段上交给传输层
网络层协议存在于每一个主机和路由器
路由器检查每一个经过它的IP数据报头部 -- 经过路由器会有一个解封装再封装的过程，到接收端会有一个大的解封装

### 网络层的功能
转发和路由
转发是一个局部的功能。路由器上面插了很多网卡，不同的网卡连接到不同的网络中，在路由器中完成解封装，选择路径，将取出来的分组再封装成选择路径物理网络的帧打出去 -- 实际上就是将分组从路由器的输入接口转发到合适的输出接口
路由是全局的一个功能。使用路由算法决定分组从目标主机到目标接收主机的路径
转发依赖于路由表，路由表是由路由算法路由转发协议算出来的
转发是数据平面的功能，即局部的对到来的数据报怎么处理
路由是控制平面的功能，算出来的全局的一个怎么处理的表，具体该怎么做
传统的转发方式：路由器上插了不同的网卡，网卡接受到帧，将帧中的分组取出来，交到网络层，网络层拿到目标IP，查路由表，路由表决定从哪个端口放出去，然后交给对应的网卡，由网卡封装成对应物理网络的帧，放出去
![Pasted image 20260104090659.png|400](/img/user/accessory/Pasted%20image%2020260104090659.png)
传统的控制平面的路由：路由器运行了路由选择协议实体，与其他路由器相互交换路由信息分布式的算出来路由表
![Pasted image 20260104090606.png|300](/img/user/accessory/Pasted%20image%2020260104090606.png)
除此之外还有SDN(software-defined networking)的方式, SDN基于多个字段，包括帧中的源端口，目标端口；分组中的源IP，目标IP；帧中的源MAC地址，目标MAC地址，以及一系列字段与位于SDN交换机或SDN路由器中的流表做匹配，做出不同的动作
传统方式下只看源IP目标IP，只有一种动作，即转发
SDN方式下对多个字段做匹配，动作有多种，比如转发，泛洪，阻止，修改...
流表是网络操作系统算出来的
集中式的网络操作系统实际上是跟每个交换路由设备的CA(控制代理)打交道，获取信息，并且将算出来的流表发布给各个交换路由设备
![Pasted image 20260104091016.png|450](/img/user/accessory/Pasted%20image%2020260104091016.png)

有些网络的网络层中涉及到了连接的建立，比如ATM网络，除了源主机和目标主机的连接，还涉及到路径上一系列路由器的连接，在每一个路由交换设备上都维持了哪个主机和哪个主机相交互的的信息
这种连接叫做有连接 -- 与TCP不同，TCP的连接叫面向连接，叫面向连接是因为只体现在目标和源上
对有一些网络，网络连接是第三个功能

### 网络服务模型
采用哪些指标来描述网络服务模型？
对单个数据报的来说：
- 可靠传送
- 延迟保证
对于数据报流的服务而言：
- 保序
- 保证流的最小带宽
- 分组之间的延迟差

当这些指标等于相应值的时候，就称网络像上层提供的服务可以用一个术语来表示，Service model(服务模型)，用来表示这一种网络情况
![Pasted image 20260104093245.png|500](/img/user/accessory/Pasted%20image%2020260104093245.png)
IP：尽力而为 -- 啥也不保证hh
